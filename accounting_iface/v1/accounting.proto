syntax = "proto3";
package accounting_iface.v1;

import "buf/validate/validate.proto";
import "common/v1/common.proto";

option go_package = "github.com/pdcgo/schema/services/accounting_iface/v1;accounting_iface";

// Service untuk accouting rekening
service AccountService {
  rpc AccountCreate(AccountCreateRequest) returns (AccountCreateResponse);
  rpc AccountList(AccountListRequest) returns (AccountListResponse);
  rpc AccountDelete(AccountDeleteRequest) returns (AccountDeleteResponse);
  rpc AccountUpdate(AccountUpdateRequest) returns (AccountUpdateResponse);
  rpc LabelList(LabelListRequest) returns (LabelListResponse);
  rpc AccountTypeList(AccountTypeListRequest) returns (AccountTypeListResponse);
}

message AccountTypeListRequest {}
message AccountTypeItem {
  string key = 1;
  string name = 2;
}
message AccountTypeListResponse {
  repeated AccountTypeItem data = 1;
}

message LabelListRequest {
  string keyword = 1;
}
message LabelListResponse {
  repeated common.v1.KeyName data = 1;
}

message AccountUpdateRequest {
  uint64 team_id = 1;
  uint64 id = 2;
  string name = 3;
  string number_id = 4;
  repeated common.v1.KeyName labels = 5;
}

message AccountUpdateResponse {}

message AccountDeleteRequest {
  uint64 team_id = 1 [(buf.validate.field).required = true];
  repeated uint64 account_ids = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).repeated.min_items = 1,
    (buf.validate.field).repeated.unique = true,
    (buf.validate.field).repeated.items.uint64.gt = 0,
    (buf.validate.field).repeated.max_items = 10
  ];
}

message AccountDeleteResponse {}

message AccountItem {
  uint64 id = 1;
  uint64 team_id = 2;
  string name = 3;
  string number_id = 4;
  string account_type = 5;
  // @gotags: gorm:"-"
  repeated common.v1.KeyName labels = 6;
}

message AccountListRequest {
  uint64 team_id = 1;
  repeated string labels = 2;
  string keyword = 3;
}

message AccountListResponse {
  repeated AccountItem data = 2;
}

message AccountCreateRequest {
  uint64 team_id = 1 [(buf.validate.field).required = true];
  string name = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.max_len = 100
  ];
  string number_id = 3 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.max_len = 100
  ];
  uint64 account_type_id = 4 [(buf.validate.field).required = true];
  repeated common.v1.KeyName labels = 5 [(buf.validate.field).repeated.max_items = 5];
}

message AccountCreateResponse {}
