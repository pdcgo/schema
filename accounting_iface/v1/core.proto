syntax = "proto3";
package accounting_iface.v1;

import "buf/validate/validate.proto";

option go_package = "github.com/pdcgo/schema/services/accounting_iface/v1;accounting_iface";

service CoreService {
  rpc AccountKeyList(AccountKeyListRequest) returns (AccountKeyListResponse);
  rpc TypeLabelList(TypeLabelListRequest) returns (TypeLabelListResponse);
  // rpc TypeLabelValueList(TypeLabelValueListRequest) returns (TypeLabelValueListResponse);
}

message TypeLabelValueListRequest {
  string q = 1;
  LabelKey key = 2;
}

message TypeLabelValueListResponse {
  repeated string list = 1;
}

message TypeLabelListRequest {}

message TypeLabelListResponse {
  repeated TypeLabel list = 1;
}

enum CoaCode {
  COA_CODE_UNSPECIFIED = 0;
  COA_CODE_ASSET = 10;
  COA_CODE_LIABILITY = 20;
  COA_CODE_EQUITY = 30;
  COA_CODE_REVENUE = 40;
  COA_CODE_EXPENSE = 50;
}

enum BalanceType {
  BALANCE_TYPE_UNSPECIFIED = 0;
  BALANCE_TYPE_DEBIT = 1;
  BALANCE_TYPE_CREDIT = 2;
}

message CoaDetail {
  CoaCode code = 1;
  bool true_account = 2;
}

// untuk custom filter data account entah spesifik cs, supplier atau custom tag
message AccountFilterExtra {
  bool cs = 1;
  bool supplier = 2;
  bool shop = 3;
  bool custom_tag = 4;
  repeated LabelKey allowed_label_key = 6;
  bool team = 5;
}

message AccountKeyItem {
  string key = 1;
  CoaCode coa = 2;
  BalanceType balance_type = 3;
  // @gotags: gorm:"-"
  AccountFilterExtra filter_extra = 4;
  // @gotags: gorm:"-"
  CoaDetail coa_detail = 5;
}

message AccountKeyListRequest {
  string q = 1;
  uint64 team_id = 2 [(buf.validate.field).uint64.gt = 0];
}

message AccountKeyListResponse {
  repeated AccountKeyItem keys = 1;
}

// untuk labeling
enum LabelKey {
  LABEL_KEY_UNSPECIFIED = 0;
  LABEL_KEY_MARKETPLACE = 1;
}

message TypeLabel {
  // @gotags: gorm:"index:keyval,unique"
  LabelKey key = 1;
  // @gotags: gorm:"index:keyval,unique"
  string label = 2;
}

message TypeLabelList {
  repeated TypeLabel list = 1;
}
