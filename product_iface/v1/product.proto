syntax = "proto3";
package product_iface.v1;

// import "accounting_iface/v1/core.proto";
import "buf/validate/validate.proto";
// import "common/v1/common.proto";
// import "google/protobuf/timestamp.proto";

option go_package = "github.com/pdcgo/schema/services/product_iface/v1;product_iface";

service ProductService {
  rpc ProductDuplicate(ProductDuplicateRequest) returns (ProductDuplicateResponse);
  rpc ProductMapGet(ProductMapGetRequest) returns (ProductMapGetResponse);
  rpc ProductMapConnect(ProductMapConnectRequest) returns (ProductMapConnectResponse);

  // info Product
  rpc ProductByIDs(ProductByIDsRequest) returns (ProductByIDsResponse);
}

message ProductByIDsRequest {
  repeated uint64 ids = 1 [(buf.validate.field).repeated = {
    min_items: 1
    max_items: 100
    items: {
      uint64: {gt: 0}
    }
  }];

  bool include_variant = 2;
}

message ProductIDsData {
  uint64 id = 1;
  string name = 2;
  repeated string images = 3;
}

message ProductByIDsResponse {
  map<uint64, ProductIDsData> products = 1;
}

message ProductDuplicateRequest {
  uint64 team_id = 1 [(buf.validate.field).uint64.gt = 0];
  uint64 variation_id = 2 [(buf.validate.field).uint64.gt = 0];
}
message ProductDuplicateResponse {
  uint64 new_product_id = 1;
  uint64 new_variation_id = 2;
}

message ProductMapGetRequest {
  uint64 team_id = 1 [(buf.validate.field).uint64.gt = 0];
  uint64 variation_id = 2 [(buf.validate.field).uint64.gt = 0];
}

message ProductMapGetResponse {
  uint64 product_id = 1;
  uint64 variation_id = 2;
  uint64 team_id = 3;
}

message ProductMapConnectRequest {
  uint64 team_id = 1 [(buf.validate.field).uint64.gt = 0];
  uint64 variation_id = 2 [(buf.validate.field).uint64.gt = 0];
  uint64 to_variation_id = 3 [(buf.validate.field).uint64.gt = 0];
}

message ProductMapConnectResponse {}
