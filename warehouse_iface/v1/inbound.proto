syntax = "proto3";

package warehouse_iface.v1;

// import "buf/validate/validate.proto";
// import "common/v1/common.proto";
// import "google/protobuf/timestamp.proto";

option go_package = "github.com/pdcgo/schema/services/warehouse_iface/v1;warehouse_iface";

service InboundService {
  // rpc ResyncStockPending(ResyncStockPendingRequest) returns (ResyncStockPendingResponse);
  rpc InboundAccept(InboundAcceptRequest) returns (InboundAcceptResponse);
  rpc InboundReject(InboundRejectRequest) returns (InboundRejectResponse);
  rpc InboundDetailSearch(InboundDetailSearchRequest) returns (InboundDetailSearchResponse);
  rpc InboundCancel(InboundCancelRequest) returns (InboundCancelResponse);
}

enum ProblemType {
  PROBLEM_TYPE_UNSPECIFIED = 0;
  PROBLEM_TYPE_BROKEN_S = 1;
  PROBLEM_TYPE_LOST_S = 2;
  PROBLEM_TYPE_BROKEN_W = 3;
  PROBLEM_TYPE_LOST_W = 4;
  PROBLEM_TYPE_DISASTER = 5;
  PROBLEM_TYPE_SAMPLE = 6;
}

enum SearchBy {
  SEARCH_BY_UNSPECIFIED = 0;
  SEARCH_BY_ID = 1;
  SEARCH_BY_RECEIPT = 2;
  SEARCH_BY_ORDERID = 3;
}

// message ResyncStockPendingRequest {
//   uint64 warehouse_id = 1;
// }

// message ResyncStockPendingResponse {}

message InboundCancelRequest {
  uint64 inv_transaction_id = 1;
  uint64 warehouse_id = 2;
  string reason = 3;
}
message InboundCancelResponse {}

message InboundDetailSearchRequest {
  SearchBy search_by = 1;
  string q = 2;
  uint64 inv_transaction_id = 3;
}

message InboundDetail {
  uint64 id = 1;
  uint64 team_id = 2;
  uint64 warehouse_id = 3;
  string receipt = 4;
  string type = 5;
  string status = 6;
}

message InboundDetailSearchResponse {
  InboundDetail inbound = 1;
}

message PlacementItem {
  uint64 rack_id = 1;
  int64 count = 2;
  ProblemType problem_type = 3;
  string note = 4;
}

message PlacementList {
  repeated PlacementItem list = 1;
}

message InboundAcceptRequest {
  uint64 inv_transaction_id = 1;
  uint64 warehouse_id = 2;

  double warehouse_fee = 3;
  string tx_type = 4;
  map<string, PlacementList> placement = 5;
}

message InboundAcceptResponse {
  uint64 tx_id = 1;
}

message InboundRejectRequest {
  uint64 inv_transaction_id = 1;
  uint64 warehouse_id = 2;
  string reason = 3;
}

message InboundRejectResponse {}
